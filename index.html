<!DOCTYPE html>
<html>
<head>
	<title>Dicionário de dados</title>
	
	<div class="container">
		


	</div>

</head>
<body>


	<script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
	<script type="text/javascript">

		String.prototype.replaceAll = function(search, replacement) {
		    var target = this;
		    return target.replace(new RegExp(search, 'g'), replacement);
		};


		var template = `
<center><b>Tabela @{{table.id}} - Descrição da tabela @{{table.name}}</b></center>

<br/>

<table>
	<tr>
		<td colspan="2" class="titulo">Entidade/Tabela</td>
		<td colspan="4" class="descricao">@{{table.name}}</td>
	</tr>
	<tr>
		<td colspan="2" class="titulo">Descrição</td>
		<td colspan="4" class="descricao">@{{table.comment}}</td>
	</tr>
	<tr>
		<td colspan="6" class="titulo">Definição dos atributos/campos</td>
	</tr>
	<tr>
		<td class="titulo">Nome</td>
		<td class="titulo">Tipo</td>
		<td class="titulo">Tamanho</td>
		<td class="titulo">Nulidade</td>
		<td class="titulo">Chave</td>
		<td class="titulo">Descrição</td>
	</tr>
	@{{registros}}
</table>

<br/><br/>
		`;

		var template_line = `
<tr>
	<td class="descricao">@{{column.name}}</td>
	<td class="descricao">@{{column.type}}</td>
	<td class="descricao">@{{column.size}}</td>
	<td class="descricao">@{{column.nullable}}</td>
	<td class="descricao">@{{column.key}}</td>
	<td class="descricao">@{{column.comment}}</td>
</tr>

		`;

		$(document).ready(function(){

			$.ajax({
				url: "exemplo.php",
				method: "GET",
				dataType: "json",
				success: function(data){

					var aux_full_html = "";

					$.each(data, function(index, value){


						
						var aux_register_html = template;
						var aux_all_lines_html = "";

						aux_register_html = aux_register_html.replaceAll("@{{table.id}}", value.id);
						aux_register_html = aux_register_html.replaceAll("@{{table.name}}", value.table);
						aux_register_html = aux_register_html.replaceAll("@{{table.comment}}", value.comment);
						

						$.each(value, function(_index,_value){

							console.log(_value);

							var aux_line_html = template_line;

							aux_line_html = aux_line_html.replaceAll("@{{column.name}}",_value.description);
							aux_line_html = aux_line_html.replaceAll("@{{column.type}}",_value.type);
							aux_line_html = aux_line_html.replaceAll("@{{column.size}}",_value.size);
							aux_line_html = aux_line_html.replaceAll("@{{column.nullable}}",_value.nullable);
							aux_line_html = aux_line_html.replaceAll("@{{column.key}}",_value.key);
							aux_line_html = aux_line_html.replaceAll("@{{column.comment}}",_value.comment);

							aux_all_lines_html += aux_line_html;

						});

						aux_full_html += aux_register_html.replaceAll("@{{registros}}", aux_all_lines_html);

					});




					$(".container").html(aux_full_html);
				},
				error: function(request, data){
					console.log(request, data);
				}
			});

		});

	</script>
</body>
</html>


